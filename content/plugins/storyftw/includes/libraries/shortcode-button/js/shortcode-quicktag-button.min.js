window.wp_sc_buttons=window.wp_sc_buttons||{},window.wp_sc_buttons.qt=function(window,document,$,QTags,buttons,scbuttons,undefined){"use strict";if(buttons){scbuttons.log=function(){scbuttons.log.history=scbuttons.log.history||[],scbuttons.log.history.push(arguments),window.console&&window.console.log(Array.prototype.slice.call(arguments))},$.fn.serializeObject=function(){var o={},a=this.serializeArray();return $.each(a,function(){o[this.name]!==undefined?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o};for(var Button=function(params){var btn={params:params,isVisual:!1,$:{}},cached=!1;return btn.cache=function(){cached||(btn.$.modal=$(document.getElementById(params.slug+"-form")),btn.$.form=btn.$.modal.find("form"),cached=!0)},btn.create=function(){var $this=$(this),$form=$this.parent(),$submitBtn=$form.find(".ui-dialog-buttonpane button:last-child");$submitBtn.focus().addClass("button-primary"),$this.on("keypress",function(evt){13===evt.keyCode&&(evt.preventDefault(),$submitBtn.click())})},btn.close=function(){btn.$.form.trigger("reset")},btn.cancel=function(){btn.$.modal.dialog("close")},btn.insert=function(){var formData=btn.$.form.serializeObject();formData.action="wp_sc_form_process_"+params.slug;var formFail=function(response){scbuttons.log("response failure",response),scbuttons.log("ajaxurl",ajaxurl),scbuttons.log("formData",formData),scbuttons.log("buttonParams",params),btn.$.modal.dialog("close")};$.post(ajaxurl,formData,function(response){response.success?btn.insertCallback(response.data):formFail(response)}).fail(formFail)},btn.buildShortCode=function(shortcode_params){var shortcode="["+params.slug;return $.each(shortcode_params,function(key,value){shortcode+=" "+key+'="'+value+'"'}),shortcode+="]"},btn.insertCallback=function(shortcode_params){var shortcodeToInsert=btn.buildShortCode(shortcode_params);shortcodeToInsert&&(btn.isVisual&&scbuttons.visualmode[params.slug]?scbuttons.visualmode[params.slug].execCommand("mceInsertContent",0,shortcodeToInsert):QTags.insertContent(shortcodeToInsert),btn.$.modal.dialog("close"))},btn.init=function(){btn.cache();var buttons={};buttons[params.l10ncancel]=btn.cancel,buttons[params.l10ninsert]=btn.insert;var args={dialogClass:params.modalClass,modal:!0,autoOpen:!1,draggable:!1,height:params.modalHeight,width:params.modalWidth,closeOnEscape:!0,buttons:buttons,create:btn.create,close:btn.close};btn.$.modal.dialog(args)},btn.open=function(isVisual){btn.cache(),btn.isVisual=!0===isVisual,btn.$.modal.dialog("open")},btn},qt={},i=buttons.length-1;i>=0;i--){var button=new Button(buttons[i]);button.init(),QTags.addButton(button.params.slug,button.params.qt_button_text,button.open),qt[button.params.slug]=button}return qt}}(window,document,jQuery,QTags,shortcodeButtonsl10n,wp_sc_buttons);