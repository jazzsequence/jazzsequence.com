(()=>{"use strict";var e={20:(e,t,a)=>{var n=a(609),r=Symbol.for("react.element"),l=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,a){var n,s={},u=null,i=null;for(n in void 0!==a&&(u=""+a),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(i=t.ref),t)l.call(t,n)&&!c.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===s[n]&&(s[n]=t[n]);return{$$typeof:r,type:e,key:u,ref:i,props:s,_owner:o.current}}},848:(e,t,a)=>{e.exports=a(20)},609:e=>{e.exports=window.React}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,a),l.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};a.r(n),a.d(n,{getAccounts:()=>N});var r={};a.r(r),a.d(r,{addAccount:()=>V,addAccountToState:()=>B,deleteAccount:()=>D,deleteAccountFromState:()=>O,setAccounts:()=>T});var l=a(609);const o=window.wp.i18n,c=window.wp.plugins,s=window.wp.editor,u=((0,l.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 591 89"},(0,l.createElement)("path",{fill:"#000",d:"M561.16 74.864c-18.816 0-30.912-9.792-30.912-26.304 0-16.896 12.288-26.976 30.72-26.976 19.584 0 30.912 11.232 29.664 30.144h-44.16c.192 7.68 5.856 12.288 15.072 12.288 6.816 0 12.384-2.592 13.728-6.432h15.264c-1.44 10.368-13.536 17.28-29.376 17.28Zm-.288-42.336c-8.064 0-13.44 3.744-14.592 10.272h28.32c-.576-6.336-5.376-10.272-13.728-10.272ZM487.311 74.864c-13.44 0-22.368-6.144-22.368-24v-28.32h16.224v25.44c0 9.312 3.072 14.688 11.712 14.688s14.208-5.952 14.208-14.592V22.544h16.224V74h-15.552l-.672-9.024h-.768c-3.168 6.048-10.752 9.888-19.008 9.888ZM439.831 74V4.016h16.128V74h-16.128ZM407.199 74.768c-9.792 0-16.224-3.552-19.296-8.928h-.672l-.48 8.16h-15.264V4.016h16.128V30.8h.576c3.264-5.76 10.656-9.216 19.008-9.216 15.168 0 25.248 10.368 25.248 26.592 0 16.32-10.08 26.592-25.248 26.592Zm-4.992-12.192c8.448 0 14.016-5.184 14.016-14.4 0-9.024-5.568-14.304-14.016-14.304-9.216 0-14.592 5.856-14.592 13.248v2.4c0 7.2 5.376 13.056 14.592 13.056ZM333.069 74.96c-18.624 0-31.008-9.888-31.008-26.688 0-16.704 12.288-26.688 31.008-26.688 18.624 0 30.912 9.792 30.912 26.688 0 16.704-12.192 26.688-30.912 26.688Zm0-12.384c9.312 0 14.784-5.568 14.784-14.304 0-8.832-5.376-14.304-14.784-14.304-9.408 0-14.784 5.568-14.784 14.304s5.376 14.304 14.784 14.304ZM283.375 74c-8.544 0-14.016-4.032-14.016-12.768V34.736h-9.6V22.544h9.6V9.488l15.936-3.072v16.128h12.768v12.192h-12.768v21.408c0 3.168 1.536 4.128 4.704 4.128h8.064V74h-14.688ZM217.03 74.864c-13.44 0-22.369-6.144-22.369-24v-28.32h16.224v25.44c0 9.312 3.073 14.688 11.713 14.688 8.64 0 14.208-5.952 14.208-14.592V22.544h16.223V74h-15.551l-.672-9.024h-.768c-3.168 6.048-10.752 9.888-19.008 9.888ZM149.936 74.96c-15.168 0-25.344-10.368-25.344-26.688s10.176-26.592 25.344-26.592c9.888 0 16.32 3.648 19.296 8.928h.672l.48-8.064h15.36V74H169.52v-8.256h-.672c-3.168 5.664-10.464 9.216-18.912 9.216Zm4.992-12.288c9.12 0 14.496-5.856 14.496-13.248v-2.496c0-7.2-5.376-12.96-14.496-12.96-8.352 0-14.016 5.088-14.016 14.304 0 9.12 5.568 14.4 14.016 14.4Z"}),(0,l.createElement)("path",{fill:"#1285FE",d:"M41.128 59.118c2.909-1.519 6.19-3.683 9.215-6.258 3.022-2.579 5.79-5.554 7.615-8.794.909-1.622 1.583-3.32 1.878-5.092.297-1.764.196-3.612-.445-5.38-.637-1.774-1.798-3.429-3.45-4.886-1.654-1.461-3.794-2.744-6.484-3.866-4.766-1.995-9.627-2.367-14.231-1.547-4.61.82-8.967 2.8-12.932 5.465-7.924 5.338-14.338 13.378-18.13 21.045C.59 57.043-.254 63.456 1.205 68.897c1.45 5.447 5.144 9.648 9.813 12.633 4.683 3.004 10.388 4.899 16.342 5.927 5.956 1.028 12.166 1.179 17.892.562 8.244-.901 16.774-3.806 24.071-8.588C76.608 74.66 82.691 67.95 85.69 59.44c2.688-7.616 3.017-14.58 1.403-20.654-1.606-6.078-5.124-11.17-9.726-15.16-4.609-3.998-10.298-6.946-16.458-8.921-6.161-1.976-12.802-2.985-19.374-3.028-6.572-.042-13.076.873-18.969 2.815-5.887 1.948-11.187 4.923-15.222 9.101C3.309 27.751.608 33.188.097 39.554c-.525 6.37 1.064 13.566 5.093 21.53 5.01 9.931 12.607 16.801 21.16 20.752 8.556 3.957 18.031 5.055 26.998 3.721 8.968-1.339 17.466-5.107 24.071-11.044C84.02 68.591 88.695 60.414 89.76 50.63c.629-5.663.039-11.845-1.99-18.376-2.234-7.19-5.1-13.085-8.465-17.791-3.363-4.701-7.238-8.214-11.429-10.586C63.687 1.5 59.198.279 54.674.043c-4.527-.235-9.088.5-13.532 1.986-8.89 2.98-17.348 8.95-24.406 16.574C9.682 26.233 4.037 35.536.882 45.24c-.15.467.65.755.83.302 3.728-9.346 9.835-18.027 17.063-24.935C26 13.7 34.354 8.592 42.47 6.347c4.058-1.126 8.047-1.541 11.826-1.164 3.782.377 7.356 1.533 10.692 3.593 3.334 2.066 6.447 5.055 9.244 9.214 2.794 4.154 5.26 9.488 7.234 16.179 1.709 5.795 2.149 11.034 1.636 15.73-.9 8.087-4.644 14.66-10.156 19.644-5.505 4.97-12.812 8.266-20.582 9.436-7.771 1.174-15.965.227-23.252-3.126-7.29-3.362-13.71-9.078-18.127-17.711-3.662-7.177-4.874-13.175-4.49-18.07.398-4.899 2.315-8.803 5.428-12.08 3.11-3.264 7.487-5.829 12.623-7.55 5.13-1.726 10.998-2.603 16.965-2.593 5.968.005 12.033.891 17.564 2.631 5.535 1.735 10.525 4.324 14.401 7.653 3.884 3.334 6.658 7.36 7.97 12.166 1.303 4.804 1.174 10.492-1.151 17.263-2.44 7.097-7.556 12.944-14.023 17.254-6.454 4.31-14.223 7.03-21.616 7.883-5.213.609-10.985.519-16.429-.376-5.445-.892-10.558-2.594-14.482-5.074-3.939-2.495-6.642-5.65-7.754-9.648-1.102-3.999-.672-9.11 2.492-15.688 3.349-6.97 9.32-14.552 16.378-19.371 3.528-2.415 7.311-4.145 11.163-4.862 3.857-.712 7.776-.452 11.779 1.17 2.369.966 4.105 2.018 5.316 3.074 1.215 1.056 1.91 2.094 2.294 3.122.379 1.028.464 2.084.282 3.258-.181 1.165-.648 2.438-1.367 3.744-1.432 2.622-3.874 5.352-6.627 7.733-2.75 2.391-5.81 4.447-8.416 5.828-.853.458-.842 1.717-.445 2.476.397.755 1.432 1.476 2.289 1.033Z"})),(0,l.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 90 89"},(0,l.createElement)("path",{fill:"#1285FE",d:"M41.128 59.118c2.909-1.519 6.19-3.683 9.215-6.258 3.022-2.579 5.79-5.554 7.615-8.794.909-1.622 1.583-3.32 1.878-5.092.297-1.764.196-3.612-.445-5.38-.637-1.774-1.798-3.429-3.45-4.886-1.654-1.461-3.794-2.744-6.484-3.866-4.766-1.995-9.627-2.367-14.231-1.547-4.61.82-8.967 2.8-12.932 5.465-7.924 5.338-14.338 13.378-18.13 21.045C.59 57.043-.254 63.456 1.205 68.897c1.45 5.447 5.144 9.648 9.813 12.633 4.683 3.004 10.388 4.899 16.342 5.927 5.956 1.028 12.166 1.179 17.892.562 8.244-.901 16.774-3.806 24.071-8.588C76.608 74.66 82.691 67.95 85.69 59.44c2.688-7.616 3.017-14.58 1.403-20.654-1.606-6.078-5.124-11.17-9.726-15.16-4.609-3.998-10.298-6.946-16.458-8.921-6.161-1.976-12.802-2.985-19.374-3.028-6.572-.042-13.076.873-18.969 2.815-5.887 1.948-11.187 4.923-15.222 9.101C3.309 27.751.608 33.188.097 39.554c-.525 6.37 1.064 13.566 5.093 21.53 5.01 9.931 12.607 16.801 21.16 20.752 8.556 3.957 18.031 5.055 26.998 3.721 8.968-1.339 17.466-5.107 24.071-11.044C84.02 68.591 88.695 60.414 89.76 50.63c.629-5.663.039-11.845-1.99-18.376-2.234-7.19-5.1-13.085-8.465-17.791-3.363-4.701-7.238-8.214-11.429-10.586C63.687 1.5 59.198.279 54.674.043c-4.527-.235-9.088.5-13.532 1.986-8.89 2.98-17.348 8.95-24.406 16.574C9.682 26.233 4.037 35.536.882 45.24c-.15.467.65.755.83.302 3.728-9.346 9.835-18.027 17.063-24.935C26 13.7 34.354 8.592 42.47 6.347c4.058-1.126 8.047-1.541 11.826-1.164 3.782.377 7.356 1.533 10.692 3.593 3.334 2.066 6.447 5.055 9.244 9.214 2.794 4.154 5.26 9.488 7.234 16.179 1.709 5.795 2.149 11.034 1.636 15.73-.9 8.087-4.644 14.66-10.156 19.644-5.505 4.97-12.812 8.266-20.582 9.436-7.771 1.174-15.965.227-23.252-3.126-7.29-3.362-13.71-9.078-18.127-17.711-3.662-7.177-4.874-13.175-4.49-18.07.398-4.899 2.315-8.803 5.428-12.08 3.11-3.264 7.487-5.829 12.623-7.55 5.13-1.726 10.998-2.603 16.965-2.593 5.968.005 12.033.891 17.564 2.631 5.535 1.735 10.525 4.324 14.401 7.653 3.884 3.334 6.658 7.36 7.97 12.166 1.303 4.804 1.174 10.492-1.151 17.263-2.44 7.097-7.556 12.944-14.023 17.254-6.454 4.31-14.223 7.03-21.616 7.883-5.213.609-10.985.519-16.429-.376-5.445-.892-10.558-2.594-14.482-5.074-3.939-2.495-6.642-5.65-7.754-9.648-1.102-3.999-.672-9.11 2.492-15.688 3.349-6.97 9.32-14.552 16.378-19.371 3.528-2.415 7.311-4.145 11.163-4.862 3.857-.712 7.776-.452 11.779 1.17 2.369.966 4.105 2.018 5.316 3.074 1.215 1.056 1.91 2.094 2.294 3.122.379 1.028.464 2.084.282 3.258-.181 1.165-.648 2.438-1.367 3.744-1.432 2.622-3.874 5.352-6.627 7.733-2.75 2.391-5.81 4.447-8.416 5.828-.853.458-.842 1.717-.445 2.476.397.755 1.432 1.476 2.289 1.033Z"}))),i=((0,l.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"600",height:"530",version:"1.1",viewBox:"0 0 600 530"},(0,l.createElement)("path",{d:"m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z",fill:"#1185fe"})),window.wp.components),d=window.wp.data,m=window.wp.apiFetch;var p=a.n(m);function h(e){var t,a,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(a=h(e[t]))&&(n&&(n+=" "),n+=a)}else for(a in e)e[a]&&(n&&(n+=" "),n+=a);return n}const g=({account:{did:e,meta:t={}},className:a,onDelete:n=null,deleteLabel:r=null,size:c="medium"})=>{const{userData:s,isLoading:u}=((e,t)=>{const[a,n]=(0,l.useState)({handle:t.handle||"",displayName:t.name||"",avatar:t.avatar||""}),[r,o]=(0,l.useState)(!1),c=(0,l.useRef)(null);return(0,l.useEffect)((()=>((async()=>{if(!a.handle){c.current&&c.current.abort(),c.current=new AbortController;try{o(!0);const t=await p()({path:`/autoblue/v1/account?did=${e}`,signal:c.current.signal});n({handle:t.handle||a.handle,displayName:t.displayName||a.displayName,avatar:t.avatar||a.avatar})}catch(e){console.error("Error fetching user data:",e),"AbortError"!==e.name&&console.error("Error fetching user data:",e)}finally{o(!1)}}})(),()=>{c.current&&c.current.abort()})),[e,a]),{userData:a,isLoading:r}})(e,t),[d,m]=(0,l.useState)(!1);return a=function(){for(var e,t,a=0,n="",r=arguments.length;a<r;a++)(e=arguments[a])&&(t=h(e))&&(n&&(n+=" "),n+=t);return n}("mS05_wtPati8LfYBYTGx",a,"small"===c&&"LUuMlpzD9HyupHyt98G3","large"===c&&"iVtkCNHNWdxuifShiMKh"),u?(0,l.createElement)("div",{className:a},(0,l.createElement)("div",{className:"IVZmEOtE_7uqQA_z7LDw"},(0,l.createElement)(i.Spinner,null))):(0,l.createElement)("div",{className:a},(0,l.createElement)("div",{className:"F2ZNrdlk8l4sx61TvagD"},(0,l.createElement)("figure",{className:"UPhsTTWKWZwbzXMghRps"},s.avatar&&(0,l.createElement)("img",{src:s.avatar,alt:s.displayName,style:{display:d?"block":"none"},onLoad:()=>m(!0),onError:()=>m(!1)})),(0,l.createElement)("div",{className:"zMF2PjNx4vXZ8jAMdrMm"},(0,l.createElement)("span",{className:"ADqq9wMPxBktKNS_YSlo"},s.displayName),(0,l.createElement)("span",{className:"BoWAC4fmJvi3BgVUzxXI"},"@",s.handle))),n&&(0,l.createElement)(i.Button,{icon:r?void 0:"no-alt",isDestructive:!0,variant:r?"secondary":void 0,onClick:n,label:r||(0,o.__)("Delete","autoblue")},r||null))},_=window.wp.date,E=window.wp.primitives;var b=a(848);const v=(0,b.jsx)(E.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,b.jsx)(E.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),f=window.wp.element,w=()=>{const{shares:e,isSharingEnabled:t}=(()=>{var e;const[t,a]=(0,f.useState)(null),[n,r]=(0,f.useState)(0),l=(0,d.useSelect)((e=>{const{getCurrentPostAttribute:t,getCurrentPostId:a}=e(s.store),n=t("meta")||{};return{isSharingEnabled:n?.autoblue_enabled||!1,shares:n?.autoblue_shares||[],postId:a()}}),[]);(0,f.useEffect)((()=>{const{postId:e,shares:o}=l,c=o.length>0||t?.autoblue_shares?.length>0;if(!e||c||n>=60)return;const s=setInterval((async()=>{r((e=>e+1)),(await(async()=>{try{const t=await p()({path:`/wp/v2/posts/${e}`,method:"GET"});return!!t.meta&&(a(t.meta),t.meta.autoblue_shares?.length>0)}catch(e){return!1}})()||n>=59)&&clearInterval(s)}),1e3);return()=>clearInterval(s)}),[l,t?.autoblue_shares?.length,n]);const o=t?.autoblue_shares||l.shares;return{shares:o,hasShares:o.length>0,isSharingEnabled:null!==(e=t?.autoblue_enabled)&&void 0!==e?e:l.isSharingEnabled}})(),{postType:a}=(0,d.useSelect)((e=>{const{getCurrentPostType:t}=e("core/editor");return{postType:t()}}),[]);if("post"!==a)return null;const{formats:n}=(0,_.getSettings)();return t?e.length?(0,l.createElement)("div",null,e.map((e=>{return(0,l.createElement)("div",{key:e.uri,className:"qGL7bYjTQeM7wpTsMgz8"},(0,l.createElement)(i.__experimentalHStack,{alignment:"left",spacing:3},(0,l.createElement)(i.Icon,{icon:v,className:"onooQEOGucNmuOD0fDnu"}),(0,l.createElement)(i.__experimentalVStack,{spacing:0},(0,l.createElement)(i.__experimentalText,null,(0,o.__)("Shared to Bluesky","autoblue")),(0,l.createElement)(i.Tooltip,{text:(0,_.dateI18n)(n?.datetime||"c",e.date)},(0,l.createElement)(i.__experimentalText,{variant:"muted"},(0,l.createElement)("time",{dateTime:(0,_.dateI18n)("c",e.date)},(0,_.humanTimeDiff)(e.date)))))),(0,l.createElement)(i.ExternalLink,{href:(t=e.uri,a=e.did,`https://bsky.app/profile/${a}/post/${t.split("/").pop()}`)},(0,o.__)("View on Bluesky","autoblue")));var t,a}))):(0,l.createElement)(i.__experimentalHStack,{alignment:"center"},(0,l.createElement)(i.Spinner,null)):(0,l.createElement)(i.__experimentalText,{variant:"muted"},(0,o.__)("Sharing was disabled for this post.","autoblue"))},y="UbZP1LRbJlNmQJ5XIfZU",S=({onSelect:e})=>{const[t,a]=(0,f.useState)(""),[n,r]=(0,f.useState)(!1),[c,s]=(0,f.useState)([]),[u,d]=(0,f.useState)(!1);let m=null;const h=(0,f.useRef)(null),_=(0,f.useCallback)((async e=>{if(e.length>0){r(!0),h.current&&h.current.abort(),h.current=new AbortController;try{const t=await p()({path:`/autoblue/v1/search?q=${encodeURIComponent(e)}`,signal:h.current.signal});if(!t.actors)throw new Error("Unexpected response from the server");s(t.actors),d(!0)}catch(e){"AbortError"!==e.name&&(s([]),d(!0))}finally{!0!==h.current?.signal.aborted&&r(!1)}}else s([]),d(!1)}),[]);(0,f.useEffect)((()=>(m&&clearTimeout(m),m=setTimeout((()=>{_(t)}),300),()=>{clearTimeout(m),h.current&&h.current.abort()})),[t,_]);const E=n?(0,l.createElement)("div",{className:y},(0,l.createElement)(i.Spinner,null)):0===c.length&&t.length>0&&u?(0,l.createElement)("div",{className:y},(0,o.__)("No accounts found. Please try another search.","autoblue")):c.length>0?c.map((({did:t,handle:a,displayName:n,avatar:r})=>(0,l.createElement)(i.Button,{key:t,className:"WhjXMSYedjhE9iq9mGGQ",onClick:()=>e({did:t,meta:{handle:a,name:n,avatar:r}})},(0,l.createElement)(g,{account:{did:t,meta:{handle:a,name:n,avatar:r}},className:"aCyp1bdAS7uFpgfVTt4z"})))):null;return(0,l.createElement)("div",null,(0,l.createElement)(i.SearchControl,{__nextHasNoMarginBottom:!0,placeholder:(0,o.__)("Search for a Bluesky account","autoblue"),label:(0,o.__)("Bluesky Account","autoblue"),value:t,onChange:e=>a(e)}),E&&(0,l.createElement)("div",null,(0,l.createElement)(i.__experimentalVStack,{spacing:0,className:"BdtMtThHyPg6Ixs294VO"},E)))},x="SET_ACCOUNTS",C="ADD_ACCOUNT",A="DELETE_ACCOUNT",P={items:[]},M=(0,d.combineReducers)({accounts:function(e=P,t){switch(t.type){case x:return{...e,items:t.accounts};case C:return{...e,items:[...e.items,t.account]};case A:return{...e,items:e.items.filter((e=>e.did!==t.did))};default:return e}}});function N(e){return e.accounts.items}const k={...n};function T(e){return{type:x,accounts:e}}function B(e){return{type:C,account:e}}function O(e){return{type:A,did:e}}function V(e,t){return async function({dispatch:a,select:n}){a(B(await p()({path:"/autoblue/v1/connections",method:"POST",data:{did:e,app_password:t}})))}}function*D(e){try{const t=yield p()({path:"/autoblue/v1/connections",method:"DELETE",data:{did:e}});if(t.error)throw new Error(t.error);return yield O(e),t}catch(e){throw e}}const I={...r},Z="autoblue",L={reducer:M,selectors:k,actions:I,resolvers:{},initialState:autoblue.initialState};let z;try{z=(0,d.select)(Z)}catch(e){}if(!z){const e=(0,d.createReduxStore)(Z,L);(0,d.register)(e)}const j=()=>{const{accounts:e}=(0,d.useSelect)((e=>({accounts:e(Z).getAccounts()})),[]),{addAccount:t,deleteAccount:a}=(0,d.useDispatch)(Z);return{accounts:e,hasAccounts:e.length>0,addAccount:t,deleteAccount:a}},H=(0,b.jsx)(E.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24",children:(0,b.jsx)(E.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})}),R=({isOpen:e,onClose:t,selectedAccount:a,onSelectAccount:n,appPassword:r,onAppPasswordChange:c,onAddAccount:s,status:u,errorMessage:d})=>e?(0,l.createElement)(i.Modal,{title:(0,o.__)("Connect Bluesky account","autoblue"),onRequestClose:t,focusOnMount:"firstContentElement",size:"medium"},(0,l.createElement)(i.__experimentalVStack,{spacing:4},a?(0,l.createElement)(g,{account:a,onDelete:()=>n(null)}):(0,l.createElement)(S,{onSelect:n}),(0,l.createElement)(i.TextControl,{__nextHasNoMarginBottom:!0,label:(0,o.__)("App Password","autoblue"),help:(0,f.createInterpolateElement)((0,o.__)("You can create a new app password in your <a>Bluesky account settings</a>.","autoblue"),{a:(0,l.createElement)("a",{href:"https://bsky.app/settings/app-passwords",target:"_blank",rel:"noreferrer"})}),value:r,onChange:c}),(0,l.createElement)(i.__experimentalHStack,{alignment:"left"},(0,l.createElement)(i.Button,{__next40pxDefaultSize:!0,variant:"primary",onClick:s,disabled:"loading"===u},(0,o.__)("Connect Account","autoblue")),"loading"===u&&(0,l.createElement)(i.Spinner,null)),"loading"!==u&&d&&(0,l.createElement)(i.__experimentalHStack,{alignment:"left",className:"DP0h4FLv2L4zkkvcUIDh"},(0,l.createElement)(i.Icon,{icon:H}),(0,l.createElement)("p",null,d)))):null,U=()=>{const{accounts:e}=j(),{renderModal:t,openModal:a}=((e=!1)=>{const[t,a]=(0,f.useState)(e),[n,r]=(0,f.useState)(null),[c,s]=(0,f.useState)(""),[u,i]=(0,f.useState)("idle"),[d,m]=(0,f.useState)(""),{addAccount:p}=j(),h=()=>{a(!1),r(null),s("")},g=e=>{s(e)},_=async()=>{if(n)if(c){i("loading");try{await p(n.did,c),i("success"),m(""),h()}catch(e){i("error"),m((0,o.__)("Something went wrong. Make sure the app password is correct.","autoblue"))}}else m((0,o.__)("Please enter an app password.","autoblue"));else m((0,o.__)("Please pick an account to add.","autoblue"))};return{renderModal:()=>(0,l.createElement)(R,{isOpen:t,onClose:h,selectedAccount:n,onSelectAccount:r,appPassword:c,onAppPasswordChange:g,onAddAccount:_,status:u,errorMessage:d}),isOpen:t,openModal:()=>a(!0),closeModal:h}})(),{editPost:n}=(0,d.useDispatch)("core/editor"),{postType:r,postStatus:c,isEnabled:s,customMessage:u}=(0,d.useSelect)((e=>{const{getCurrentPostType:t,getEditedPostAttribute:a}=e("core/editor");return{postType:t(),postStatus:a("status"),isEnabled:a("meta")?.autoblue_enabled,customMessage:a("meta")?.autoblue_custom_message}}),[]);return"post"!==r?null:"publish"===c?(0,l.createElement)(w,null):e.length?(0,l.createElement)(i.__experimentalVStack,{spacing:3},(0,l.createElement)(i.ToggleControl,{__nextHasNoMarginBottom:!0,label:(0,o.__)("Share to Bluesky","autoblue"),checked:s,onChange:e=>{n({meta:{autoblue_enabled:e}})}}),s&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)(i.TextareaControl,{__nextHasNoMarginBottom:!0,label:(0,o.__)("Message","autoblue"),help:(0,o.__)("Add an optional message to the Bluesky post.","autoblue"),value:u,maxLength:250,onChange:e=>{n({meta:{autoblue_custom_message:e}})}}),(0,l.createElement)(i.BaseControl,{__nextHasNoMarginBottom:!0,label:(0,o.__)("Sharing to:","autoblue"),id:"autoblue-account"},e.map((e=>(0,l.createElement)(g,{key:e.did,account:e,className:"RtWJ7rQhnShEvixSHzh5",size:"small"})))))):(0,l.createElement)(i.__experimentalVStack,null,(0,l.createElement)(i.Button,{variant:"secondary",onClick:()=>a()},(0,o.__)("Connect a Bluesky account","autoblue")),t())};(0,c.registerPlugin)("autoblue-share-panel",{render:()=>(0,l.createElement)(s.PluginDocumentSettingPanel,{name:"autoblue-share-panel",title:"Autoblue",icon:u},(0,l.createElement)(U,null))}),(0,c.registerPlugin)("autoblue-prepublish-share-panel",{render:()=>(0,l.createElement)(s.PluginPrePublishPanel,{title:"Autoblue",initialOpen:!0,icon:u},(0,l.createElement)(U,null))}),(0,c.registerPlugin)("autoblue-postpublish-share-panel",{render:()=>(0,l.createElement)(s.PluginPostPublishPanel,{title:"Autoblue",initialOpen:!0,icon:u},(0,l.createElement)(w,null))})})();